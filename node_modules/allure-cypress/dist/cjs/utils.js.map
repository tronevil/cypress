{"version":3,"file":"utils.js","names":["_allureJsCommons","require","_sdk","_model","_state","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","DEFAULT_RUNTIME_CONFIG","exports","stepsFromCommands","maxArgumentLength","maxArgumentDepth","uint8ArrayToBase64","data","u8arrayLike","Array","isArray","buffer","btoa","fromCharCode","getSuites","test","suites","s","parent","reverse","getSuitePath","title","map","shouldCommandBeSkipped","command","_last","last","attributes","args","log","name","ALLURE_REPORT_STEP_COMMAND","toReversed","arr","result","resolveSpecRelativePath","spec","projectDir","getProjectDir","specPath","absolute","substring","relative","win","Cypress","platform","replaceAll","getNamesAndLabels","rawName","cleanTitle","labels","extractMetadataFromString","titlePath","slice","fullNameSuffix","concat","join","getTestStartData","_test$wallClockStarte","start","wallClockStartedAt","getTime","Date","now","getTestStopData","_test$duration","_retries","duration","retries","getTestSkipData","statusDetails","message","applyTestPlan","root","testPlan","getAllureTestPlan","suite","iterateSuites","indicesToRemove","getIndicesOfDeselectedTests","tests","removeSortedIndices","resolveStatusWithDetails","error","status","getStatusFromError","getMessageAndTraceFromError","Status","PASSED","testReportedKey","markTestAsReported","isTestReported","suiteStack","pop","iterateTests","isAllureHook","hook","includes","ALLURE_REPORT_SYSTEM_HOOK","isRootAfterAllHook","hookName","includedInTestPlan","fullName","allureId","some","_test$id","id","toString","selector","index","_labels$find","find","_ref","LabelName","ALLURE_ID","indices","splice"],"sources":["../../src/utils.ts"],"sourcesContent":["import { LabelName, Status } from \"allure-js-commons\";\nimport { extractMetadataFromString, getMessageAndTraceFromError, getStatusFromError } from \"allure-js-commons/sdk\";\nimport type { TestPlanV1 } from \"allure-js-commons/sdk\";\nimport { ALLURE_REPORT_STEP_COMMAND, ALLURE_REPORT_SYSTEM_HOOK } from \"./model.js\";\nimport type { CypressCommand, CypressHook, CypressSuite, CypressTest } from \"./model.js\";\nimport { getAllureTestPlan, getProjectDir } from \"./state.js\";\n\nexport const DEFAULT_RUNTIME_CONFIG = {\n  stepsFromCommands: {\n    maxArgumentLength: 128,\n    maxArgumentDepth: 3,\n  },\n};\n\nexport const uint8ArrayToBase64 = (data: unknown) => {\n  // @ts-ignore\n  const u8arrayLike = Array.isArray(data) || data.buffer;\n\n  if (!u8arrayLike) {\n    return data as string;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n  return btoa(String.fromCharCode.apply(null, data as number[]));\n};\n\nexport const getSuites = (test: CypressTest) => {\n  const suites: CypressSuite[] = [];\n  for (let s: CypressSuite | undefined = test.parent; s; s = s.parent) {\n    suites.push(s);\n  }\n  suites.reverse();\n  return suites;\n};\n\nexport const getSuitePath = (test: CypressTest): string[] =>\n  getSuites(test)\n    .filter((s) => s.title)\n    .map((s) => s.title);\n\nexport const shouldCommandBeSkipped = (command: CypressCommand) => {\n  if (last(command.attributes.args)?.log === false) {\n    return true;\n  }\n\n  if (command.attributes.name === \"task\" && command.attributes.args[0] === \"reportAllureRuntimeMessages\") {\n    return true;\n  }\n\n  // we don't need to report then commands because it's just a promise handle\n  if (command.attributes.name === \"then\") {\n    return true;\n  }\n\n  // we should skip artificial wrap from allure steps\n  if (command.attributes.name === \"wrap\" && command.attributes.args[0] === ALLURE_REPORT_STEP_COMMAND) {\n    return true;\n  }\n\n  return false;\n};\n\nexport const toReversed = <T = unknown>(arr: T[]): T[] => {\n  const result: T[] = [];\n\n  for (let i = arr.length - 1; i >= 0; i--) {\n    result.push(arr[i]);\n  }\n\n  return result;\n};\n\nexport const last = <T = unknown>(arr: T[]): T | undefined => {\n  return arr[arr.length - 1];\n};\n\nconst resolveSpecRelativePath = (spec: Cypress.Spec) => {\n  const projectDir = getProjectDir();\n  const specPath = projectDir ? spec.absolute.substring(projectDir.length + 1) : spec.relative;\n  const win = Cypress.platform === \"win32\";\n  return win ? specPath.replaceAll(\"\\\\\", \"/\") : specPath;\n};\n\nexport const getNamesAndLabels = (spec: Cypress.Spec, test: CypressTest) => {\n  const rawName = test.title;\n  const { cleanTitle: name, labels } = extractMetadataFromString(rawName);\n  const suites = test.titlePath().slice(0, -1);\n  const fullNameSuffix = `${[...suites, name].join(\" \")}`;\n  return { name, labels, fullNameSuffix };\n};\n\nexport const getTestStartData = (test: CypressTest) => ({\n  ...getNamesAndLabels(Cypress.spec, test),\n  start: test.wallClockStartedAt?.getTime() || Date.now(),\n});\n\nexport const getTestStopData = (test: CypressTest) => ({\n  duration: test.duration ?? 0,\n  retries: (test as any)._retries ?? 0,\n});\n\nexport const getTestSkipData = () => ({\n  statusDetails: { message: \"This is a pending test\" },\n});\n\nexport const applyTestPlan = (spec: Cypress.Spec, root: CypressSuite) => {\n  const testPlan = getAllureTestPlan();\n  if (testPlan) {\n    const specPath = resolveSpecRelativePath(spec);\n    for (const suite of iterateSuites(root)) {\n      const indicesToRemove = getIndicesOfDeselectedTests(testPlan, spec, specPath, suite.tests);\n      removeSortedIndices(suite.tests, indicesToRemove);\n    }\n  }\n};\n\nexport const resolveStatusWithDetails = (error: Error | undefined) =>\n  error\n    ? {\n        status: getStatusFromError(error),\n        statusDetails: getMessageAndTraceFromError(error),\n      }\n    : { status: Status.PASSED };\n\nconst testReportedKey = Symbol(\"The test was reported to Allure\");\n\nexport const markTestAsReported = (test: CypressTest) => {\n  (test as any)[testReportedKey] = true;\n};\n\nexport const isTestReported = (test: CypressTest) => (test as any)[testReportedKey] === true;\n\nexport const iterateSuites = function* (parent: CypressSuite) {\n  const suiteStack: CypressSuite[] = [];\n  for (let s: CypressSuite | undefined = parent; s; s = suiteStack.pop()) {\n    yield s;\n\n    // Pushing in reverse allows us to maintain depth-first pre-order traversal -\n    // the same order as used by Mocha & Cypress.\n    for (let i = s.suites.length - 1; i >= 0; i--) {\n      suiteStack.push(s.suites[i]);\n    }\n  }\n};\n\nexport const iterateTests = function* (parent: CypressSuite) {\n  for (const suite of iterateSuites(parent)) {\n    yield* suite.tests;\n  }\n};\n\nexport const isAllureHook = (hook: CypressHook) => hook.title.includes(ALLURE_REPORT_SYSTEM_HOOK);\n\nexport const isRootAfterAllHook = (hook: CypressHook) => hook.parent!.root && hook.hookName === \"after all\";\n\nconst includedInTestPlan = (testPlan: TestPlanV1, fullName: string, allureId: string | undefined): boolean =>\n  testPlan.tests.some((test) => (allureId && test.id?.toString() === allureId) || test.selector === fullName);\n\nconst getIndicesOfDeselectedTests = (\n  testPlan: TestPlanV1,\n  spec: Cypress.Spec,\n  specPath: string,\n  tests: readonly CypressTest[],\n) => {\n  const indicesToRemove: number[] = [];\n  tests.forEach((test, index) => {\n    const { fullNameSuffix, labels } = getNamesAndLabels(spec, test);\n    const fullName = `${specPath}#${fullNameSuffix}`;\n    const allureId = labels.find(({ name }) => name === LabelName.ALLURE_ID)?.value;\n\n    if (!includedInTestPlan(testPlan, fullName, allureId)) {\n      indicesToRemove.push(index);\n    }\n  });\n  return indicesToRemove;\n};\n\nconst removeSortedIndices = <T>(arr: T[], indices: readonly number[]) => {\n  for (let i = indices.length - 1; i >= 0; i--) {\n    arr.splice(indices[i], 1);\n  }\n};\n"],"mappings":"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","ignoreList":[]}